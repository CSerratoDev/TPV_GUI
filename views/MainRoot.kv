#:import hex kivy.utils.get_color_from_hex
<ActionButton@Button>:
    background_normal: ''
    background_color: hex('#DE9116')

<DarkButton@Button>:
    background_normal: ''
    background_color: hex('#252525')

<ProductButton@Button>:
    background_normal: ''
    background_color: hex('#435be1ff')

<DarkLabel@Label>:
    color: hex('#252525')

<DarkBox@Label>:
    canvas.before:
        Color:
            rgba: hex('#252525')
        Rectangle:
            pos: self.pos
            size: self.size
    color: (1,1,1,1)

<MessagePopup>:
    title: 'Aviso del sistema'
    size_hint: None, None
    size: 400, 200
    auto_dismiss: False

    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 10
        Label:
            text: root.message
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'
        Button:
            text: 'Aceptar'
            size_hint_y: None
            height: 50
            on_release: root.dismiss()

<MainRoot>:
    orientation: 'vertical'
    search_id: search_product_id
    search_name: search_product_name

    canvas.before:
        Color:
            rgba: hex('#ECF0EF')
        Rectangle:
            pos: self.pos 
            size: self.size

    BoxLayout:
        size_hint_y: 0.08
        canvas.before:
            Color:
                rgba: hex('#37E6A3')
            Rectangle:
                pos: self.pos 
                size: self.size

        ActionButton: 
            text: '+'
            size_hint_x: 0.1
            on_release: root.reset()

        DarkLabel:
            size_hint_x: 0.5
            id: title_label
            text: 'Sistema para Control de Inventario y Ventas'
            font_size: '18sp'
            bold: True

        GridLayout:
            size_hint_x: 0.2
            rows: 2
            cols: 2
            DarkLabel: 
                text: 'Fecha: '
                font_size: '12sp'
            DarkLabel:
                id: date
                font_size: '12sp'
            DarkLabel:
                text: 'Hora: '
                color: hex('#252525')
                font_size: '12sp'
            DarkLabel:
                id: time
                color: hex('#252525')
                font_size: '12sp'

        DarkButton:
            id: admin_button
            size_hint_x: 0.1
            text: 'Admin'
            on_release: root.admin()
        DarkButton:
            id: exit_button
            size_hint_x: 0.1
            text: 'Salir'
            on_release: root.exit()

    # Sidenav and Buttons
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: 0.87
        
        BoxLayout:
            orientation:'vertical'
            padding: 5
            spacing: 5

            BoxLayout:
                size_hint_y: 0.1
                spacing: 5

                TextInput:
                    id: search_product_name
                    hint_text: 'Nombre del producto'
                    multiline: False
                TextInput:
                    id: search_product_id
                    hint_text: 'ID del producto'
                    multiline: False
                    size_hint_x: 0.4
                ActionButton:
                    text: 'Buscar'
                    size_hint_x: 0.3
                    on_release: root.add_product(search_product_id.text, search_product_name.text)
                
            BoxLayout:
                size_hint_y: 0.05
                DarkBox:
                    text: '#'
                    size_hint_x: .1
                DarkBox:
                    text: 'Producto'
                    size_hint_x: .5
                DarkBox:
                    text: 'Cantidad'
                    size_hint_x: .1
                DarkBox:
                    text: 'Precio'
                    size_hint_x: .15
                DarkBox:
                    text: 'Total x Cantidad'
                    size_hint_x: .15

            ScrollView:
                do_scroll_x: False
                canvas.before:
                    Color:
                        rgba: hex('#ECF0EF')
                    Rectangle:
                        pos: self.pos
                        size: self.size
                GridLayout:
                    id: cart_container 
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: 2

                    row_default_height: '36dp'
                    row_force_default: True

        BoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.3
            padding: 10
            spacing: 15
                
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: 0.3
                DarkLabel:
                    text: "TOTAL"
                    font_size: '18sp'
                DarkLabel:
                    id: total_label
                    text: "$ 0.00"
                    font_size: '36sp'
                    bold: True

            # Product Configuration
            GridLayout:
                rows: 3
                cols: 2
                spacing: 5

                TextInput:
                    id: edit_price
                    hint_text: 'Nuevo Precio'
                    input_filter: 'float'
                TextInput:
                    id: edit_quantity
                    hint_text: 'Cantidad'
                    input_filter: 'int'
                ProductButton:
                    text: "Agregar"
                    background_color: hex('#DE9116')
                    on_release: root.add_product(search_product_id.text,search_product_name.text) 
                ProductButton:
                    text: "Editar"
                    background_color: hex('#216dc4ff')
                    on_release: root.update_product(search_product_id.text, edit_price.text, edit_quantity.text)
                ProductButton:
                    text: "Borrar"
                    background_color: hex('#F63049')
                    on_release: root.delete_product()
                ProductButton:
                    text: "Consultar"
                    background_color: hex('#0fce19ff')
                    on_release: root.check_price()        

            Button:
                text: "COBRAR"
                background_normal: ''
                background_color: hex('#1faa75ff')
                font_size: '24sp'
                bold: True
                on_release: root.sell()
            Button:
                text: "CANCEL"
                background_normal: ''
                background_color: hex('#D1262F')
                on_release: root.reset()
    # Footer
    BoxLayout:
        size_hint_y: 0.05
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: hex('#252525')
            Rectangle:
                pos: self.pos 
                size: self.size
        Label:
            text: "Created by: cserrato.dev"
            font_size: '6sp'
            color: hex('#ffffff')